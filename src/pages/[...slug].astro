---
import { type CollectionEntry, getCollection, render } from 'astro:content'
import FormattedDate from '../components/FormattedDate.astro'
import Layout from '../components/layout.astro'

export async function getStaticPaths() {
  const posts = await getCollection('post')
  return posts.map(post => ({
    params: { slug: post.id },
    props: post,
  }))
}
type Props = CollectionEntry<'post'>

const post = Astro.props
const { Content } = await render(post)
const { title, description, emoji, created, updated } = post.data
---

<Layout title={title} description={description} >
	<div class="hero-image">
		{emoji && <div>{emoji}</div>}
	</div>
	<div class="prose">
		<div class="title">
			<div class="date">
				<FormattedDate date={created} />
				{
					updated && (
						<div class="last-updated-on">
							Last updated on <FormattedDate date={updated} />
						</div>
					)
				}
			</div>
			<h1>{title}</h1>
			<hr />
		</div>
		<Content />
	</div>
</Layout>
